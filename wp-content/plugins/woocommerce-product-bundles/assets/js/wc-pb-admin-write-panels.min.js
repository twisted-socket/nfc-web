jQuery(function(a){function b(a){var b=this;this.$content=a.find("div.item-data"),this.$discount=this.$content.find(".discount"),this.$visibility=this.$content.find(".item_visibility"),this.$price_visibility=this.$content.find(".price_visibility"),this.$allowed_variations=this.$content.find("div.allowed_variations"),this.$default_variation_attributes=this.$content.find("div.default_variation_attributes"),this.$custom_title=this.$content.find("div.custom_title"),this.$custom_description=this.$content.find("div.custom_description"),this.$override_title=this.$content.find(".override_title"),this.$override_description=this.$content.find(".override_description"),this.$hide_thumbnail=this.$content.find(".hide_thumbnail"),this.$section_links=this.$content.find(".subsubsub a"),this.$sections=this.$content.find(".options_group"),this.$priced_individually_input=this.$content.find(".priced_individually input"),this.$override_variations_input=this.$content.find(".override_variations input"),this.$override_defaults_input=this.$content.find(".override_default_variation_attributes input"),this.$override_title_input=this.$override_title.find("input"),this.$override_description_input=this.$override_description.find("input"),this.$price_visibility_product_input=this.$price_visibility.find("input.price_visibility_product"),this.$price_visibility_cart_input=this.$price_visibility.find("input.price_visibility_cart"),this.$price_visibility_order_input=this.$price_visibility.find("input.price_visibility_order"),this.$visibility_product_input=this.$visibility.find("input.visibility_product"),this.$visibility_cart_input=this.$visibility.find("input.visibility_cart"),this.$visibility_order_input=this.$visibility.find("input.visibility_order"),this.priced_individually_input_changed=function(){b.$priced_individually_input.is(":checked")?(b.$discount.show(),b.$price_visibility.show()):(b.$discount.hide(),b.$price_visibility.hide())},this.override_variations_input_changed=function(){b.$override_variations_input.is(":checked")?b.$allowed_variations.show():b.$allowed_variations.hide()},this.override_defaults_input_changed=function(){b.$override_defaults_input.is(":checked")?b.$default_variation_attributes.show():b.$default_variation_attributes.hide()},this.override_title_input_changed=function(){b.$override_title_input.is(":checked")?b.$custom_title.show():b.$custom_title.hide()},this.override_description_input_changed=function(){b.$override_description_input.is(":checked")?b.$custom_description.show():b.$custom_description.hide()},this.visibility_product_input_changed=function(){b.$visibility_product_input.is(":checked")?(b.$override_title.show(),b.$override_description.show(),b.$hide_thumbnail.show(),b.override_title_input_changed(),b.override_description_input_changed()):(b.$override_title.hide(),b.$override_description.hide(),b.$hide_thumbnail.hide(),b.$custom_description.hide(),b.$custom_title.hide())},this.toggled_visibility=function(a){b["$visibility_"+a+"_input"].is(":checked")?b["$price_visibility_"+a+"_input"].css("opacity",1):b["$price_visibility_"+a+"_input"].css("opacity",.5)},this.section_changed=function(a){b.$section_links.removeClass("current"),a.addClass("current"),b.$sections.addClass("options_group_hidden"),b.$content.find(".options_group_"+a.data("tab")).removeClass("options_group_hidden")},this.initialize=function(){b.priced_individually_input_changed(),b.override_variations_input_changed(),b.override_defaults_input_changed(),b.override_title_input_changed(),b.override_description_input_changed(),b.visibility_product_input_changed(),b.toggled_visibility("product"),b.toggled_visibility("cart"),b.toggled_visibility("order")},this.initialize()}function c(){j.on("change",function(){var c=j.val(),d=!!(c&&c.length>0)&&("yes"===wc_bundles_admin_params.is_wc_version_gte_2_7?c.shift():c);if(!d)return!1;"yes"===wc_bundles_admin_params.is_wc_version_gte_2_7?j.val([]).change():j.select2("val",""),f.block(m),l++;var e={action:"woocommerce_add_bundled_product",post_id:woocommerce_admin_meta_boxes.post_id,id:l,product_id:d,security:wc_bundles_admin_params.add_bundled_product_nonce};return setTimeout(function(){a.post(woocommerce_admin_meta_boxes.ajax_url,e,function(c){if(""!==c.markup){h.append(c.markup);var d=a(".wc-bundled-item",h).last(),e="bundled_item_"+l;d.data("bundled_item_id",e),k[e]=new b(d),f.triggerHandler("wc-bundled-products-changed"),d.find(".woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),d.wc_bundles_select2(),f.trigger("wc-bundles-added-bundled-product")}else""!==c.message&&window.alert(c.message);j.select2("open"),j.select2("close"),f.unblock()})},250),!1}),f.on("wc-bundled-products-changed",function(){i=a(".wc-bundled-item",h),i.each(function(b,c){a(".item_menu_order",c).val(b)}),e()}),h.on("click","a.remove_row",function(b){var c=a(this).closest(".wc-bundled-item"),d=c.data("bundled_item_id");c.find("*").off(),c.remove(),delete k[d],f.triggerHandler("wc-bundled-products-changed"),b.preventDefault()}).on("change",".priced_individually input",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.priced_individually_input_changed()}).on("change",".override_variations input",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.override_variations_input_changed()}).on("change",".override_default_variation_attributes input",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.override_defaults_input_changed()}).on("change",".override_title input",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.override_title_input_changed()}).on("change",".override_description input",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.override_description_input_changed()}).on("change","input.visibility_product",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.visibility_product_input_changed(),d.toggled_visibility("product")}).on("change","input.visibility_cart",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.toggled_visibility("cart")}).on("change","input.visibility_order",function(){var b=a(this).closest(".wc-bundled-item"),c=b.data("bundled_item_id"),d=k[c];d.toggled_visibility("order")}).on("click",".subsubsub a",function(b){var c=a(this),d=a(this).closest(".wc-bundled-item"),e=d.data("bundled_item_id"),f=k[e];f.section_changed(c),b.preventDefault()})}function d(){i.each(function(c){var d=a(this),e="bundled_item_"+c;d.data("bundled_item_id",e),k[e]=new b(d)}),h.sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style"),f.triggerHandler("wc-bundled-products-changed")}}),e()}function e(){i.length>0?g.removeClass("disabled"):g.addClass("disabled")}var f=a("#bundled_product_data"),g=f.find(".toolbar"),h=a(".wc-bundled-items"),i=a(".wc-bundled-item",h),j=a("#bundled_product",f),k={},l=i.length,m={message:null,overlayCSS:{background:"#fff",opacity:.6}};a.fn.wc_bundles_select2=function(){a(document.body).trigger("wc-enhanced-select-init")},a(".bundle_stock_msg").appendTo("._manage_stock_field .description"),a("#_sold_individually").closest(".form-field").addClass("hide_if_bundle"),a("#linked_product_data .grouping.show_if_simple, #linked_product_data .form-field.show_if_grouped").addClass("hide_if_bundle"),a(".show_if_simple:not(.hide_if_bundle)").addClass("show_if_bundle"),a("body").on("woocommerce-product-type-change",function(b,c){"bundle"===c&&(a(".show_if_external").hide(),a(".show_if_bundle").show(),a("input#_manage_stock").change(),a("#_nyp").change(),"no"===wc_bundles_admin_params.is_wc_version_gte_2_7&&(a("#_regular_price").val(a("#_wc_pb_base_regular_price").val()).change(),a("#_sale_price").val(a("#_wc_pb_base_sale_price").val()).change()))}),a("select#product-type").change(),a("input#_downloadable").change(function(){a("select#product-type").change()}),c(),d()});