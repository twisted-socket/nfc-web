function wc_pb_woocommerce_number_format(a){var b=wc_bundle_params.currency_format_decimal_sep,c=wc_bundle_params.currency_position,d=wc_bundle_params.currency_symbol,e=wc_bundle_params.currency_format_trim_zeros,f=wc_bundle_params.currency_format_num_decimals;if("yes"==e&&f>0){for(var g=0;g<f;g++)b+="0";a=a.replace(b,"")}var h="";return"left"==c?h='<span class="amount">'+d+a+"</span>":"right"==c?h='<span class="amount">'+a+d+"</span>":"left_space"==c?h='<span class="amount">'+d+" "+a+"</span>":"right_space"==c&&(h='<span class="amount">'+a+" "+d+"</span>"),h}function wc_pb_number_format(a){var b=wc_bundle_params.currency_format_num_decimals,c=wc_bundle_params.currency_format_decimal_sep,d=wc_bundle_params.currency_format_thousand_sep,e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0==c?",":c,h=void 0==d?".":d,i=e<0?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f))+"",k=(k=j.length)>3?k%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")}function wc_pb_number_round(a){var b=wc_bundle_params.currency_format_num_decimals,c=Math.pow(10,b),d=a*c,e=Math.round(d);return e/c}var wc_pb_bundle_scripts={};jQuery.fn.wc_get_bundle_script=function(){var a=jQuery(this);if(!a.hasClass("bundle_form"))return!1;var b=a.data("script_id");return"undefined"!=typeof wc_pb_bundle_scripts[b]&&wc_pb_bundle_scripts[b]},function(a){function b(b){var d=this;this.bundle_id=b.bundle_id,this.$bundle_form=b.$bundle_form,this.$bundle_data=b.$bundle_data,this.$bundle_wrap=b.$bundle_data.find(".bundle_wrap"),this.$bundled_items=b.$bundle_form.find(".bundled_product"),this.$bundle_price=b.$bundle_data.find(".bundle_price"),this.$bundle_error=b.$bundle_data.find(".bundle_error"),this.$bundle_error_content=b.$bundle_data.find(".bundle_error ul.msg"),this.$bundle_button=b.$bundle_data.find(".bundle_button"),this.$bundle_quantity=this.$bundle_wrap.find("input.qty"),this.$addons_totals=!1,this.bundled_items={},this.price_data=b.$bundle_data.data("bundle_price_data"),this.$initial_stock_status=!1,this.update_bundle_timer=!1,this.update_price_timer=!1,this.validation_messages=[],this.is_initialized=!1,this.composite_data=b.composite_data,this.refreshing_addons_totals=!1,this.dirty_subtotals=!1,this.api={get_bundle_totals:function(){return d.price_data.totals},get_bundled_item_totals:function(a){return d.price_data["bundled_item_"+a+"_totals"]},get_bundled_item_recurring_totals:function(a){return d.price_data["bundled_item_"+a+"_recurring_totals"]},get_bundle_validation_status:function(){return d.passes_validation()?"pass":"fail"},get_bundle_validation_messages:function(){return d.get_validation_messages()},get_bundle_stock_status:function(){var a=d.$bundle_wrap.find("p.out-of-stock").not(".inactive");return a.length>0?"out-of-stock":"in-stock"},get_bundle_availability:function(){var a=d.$bundle_wrap.find("p.stock");return a=a.hasClass("inactive")?!1!==d.$initial_stock_status?d.$initial_stock_status.clone().wrap("<div></div>").parent().html():"":a.clone().removeAttr("style").wrap("<div></div>").parent().html()},get_bundle_configuration:function(){var b={};return 0!==d.bundled_items.length&&(a.each(d.bundled_items,function(a,c){var e={title:c.get_title(),product_id:c.get_product_id(),variation_id:c.get_variation_id(),quantity:d.price_data.quantities[c.bundled_item_id],product_type:c.get_product_type()};b[c.bundled_item_id]=e}),b)}},this.init=function(){0===this.$bundle_error_content.length&&!1===this.composite_data&&(this.$bundle_error.length>0&&this.$bundle_error.remove(),this.$bundle_price.after('<div class="bundle_error" style="display:none"><ul class="msg woocommerce-info"></ul></div>'),this.$bundle_error=this.$bundle_data.find(".bundle_error"),this.$bundle_error_content=this.$bundle_error.find(".msg"));var b=this.$bundle_data.find("#product-addons-total");b.length>0&&(this.$addons_totals=b,this.$bundle_price.after(b)),this.$bundle_wrap.find("p.stock").length>0&&(this.$initial_stock_status=this.$bundle_wrap.find("p.stock").clone()),this.price_data.suffix_exists=""!==wc_bundle_params.price_display_suffix,this.price_data.suffix=""!==wc_bundle_params.price_display_suffix?' <small class="woocommerce-price-suffix">'+wc_bundle_params.price_display_suffix+"</small>":"",this.price_data.suffix_contains_price_incl=wc_bundle_params.price_display_suffix.indexOf("{price_including_tax}")>-1,this.price_data.suffix_contains_price_excl=wc_bundle_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1,this.$bundle_button.find('input[name*="bundle_variation"], input[name*="bundle_attribute"]').remove(),this.bind_event_handlers(),this.init_bundled_items(),this.is_composited()&&this.init_composite(),this.$bundle_data.triggerHandler("woocommerce-product-bundle-initializing",[this]),a.each(this.bundled_items,function(a,b){b.init_scripts()}),this.update_bundle_task(),this.is_initialized=!0,this.$bundle_data.trigger("woocommerce-product-bundle-initialized",[this])},this.shutdown=function(){this.$bundle_form.find("*").off(),!1!==this.composite_data&&this.remove_composite_hooks()},this.init_composite=function(){this.composite_data.composite.api.is_component_priced_individually(this.composite_data.component.step_id)&&(wc_bundle_params.i18n_total=wc_bundle_params.i18n_subtotal),this.composite_data.composite.actions.add_action("component_scripts_initialized_"+this.composite_data.component.step_id,this.component_scripts_initialized_action,10,this)},this.component_scripts_initialized_action=function(){parseInt(this.composite_data.component.component_selection_model.selected_product)===parseInt(this.bundle_id)?this.add_composite_hooks():this.remove_composite_hooks()},this.add_composite_hooks=function(){this.composite_data.composite.filters.add_filter("step_is_valid",this.cp_step_is_valid_filter,10,this),this.composite_data.composite.filters.add_filter("component_selection_formatted_title",this.cp_component_selection_formatted_title_filter,10,this),this.composite_data.composite.filters.add_filter("component_selection_meta",this.cp_component_selection_meta_filter,10,this),this.composite_data.composite.filters.add_filter("component_totals",this.cp_component_totals_filter,10,this),this.composite_data.composite.filters.add_filter("component_configuration",this.cp_component_configuration_filter,10,this),this.composite_data.composite.actions.add_action("validate_step",this.cp_validation_messages_action,10,this)},this.remove_composite_hooks=function(){this.composite_data.composite.filters.remove_filter("step_is_valid",this.cp_step_is_valid_filter),this.composite_data.composite.filters.remove_filter("component_selection_formatted_title",this.cp_component_selection_formatted_title_filter),this.composite_data.composite.filters.remove_filter("component_selection_meta",this.cp_component_selection_meta_filter),this.composite_data.composite.filters.remove_filter("component_totals",this.cp_component_totals_filter),this.composite_data.composite.filters.remove_filter("component_configuration",this.cp_component_configuration_filter),this.composite_data.composite.actions.remove_action("component_scripts_initialized_"+this.composite_data.component.step_id,this.component_scripts_initialized_action),this.composite_data.composite.actions.remove_action("validate_step",this.cp_validation_messages_action)},this.cp_component_configuration_filter=function(a,b){return b.step_id===this.composite_data.component.step_id&&(a.bundled_items=d.api.get_bundle_configuration()),a},this.cp_component_totals_filter=function(b,c){if(c.step_id===this.composite_data.component.step_id){var e=Number(c.component_selection_model.get("selected_addons")),f=d.get_taxed_totals(e,e,d.price_data.base_price_tax);b.price=f.price+this.price_data.totals.price*c.get_selected_quantity(),b.regular_price=f.regular_price+this.price_data.totals.regular_price*c.get_selected_quantity(),b.price_incl_tax=f.price_incl_tax+this.price_data.totals.price_incl_tax*c.get_selected_quantity(),b.price_excl_tax=f.price_excl_tax+this.price_data.totals.price_excl_tax*c.get_selected_quantity(),a.each(d.bundled_items,function(a,e){e.is_sold_individually()&&c.get_selected_quantity()>1&&(b.price=b.price-(c.get_selected_quantity()-1)*d.price_data["bundled_item_"+e.bundled_item_id+"_totals"].price,b.regular_price=b.regular_price-(c.get_selected_quantity()-1)*d.price_data["bundled_item_"+e.bundled_item_id+"_totals"].regular_price,b.price_incl_tax=b.price_incl_tax-(c.get_selected_quantity()-1)*d.price_data["bundled_item_"+e.bundled_item_id+"_totals"].price_incl_tax,b.price_excl_tax=b.price_excl_tax-(c.get_selected_quantity()-1)*d.price_data["bundled_item_"+e.bundled_item_id+"_totals"].price_excl_tax)})}return this.updated_totals(),b},this.cp_component_selection_formatted_title_filter=function(b,c,d,e,f){if(f.step_id===this.composite_data.component.step_id){var g=0,h=this;if(a.each(h.bundled_items,function(a,b){b.$bundled_item_cart.data("quantity")>0&&g++}),f.is_static())if(0===g)b=wc_composite_params.i18n_no_selection;else{var i=this.cp_get_formatted_contents(f);i&&(b=i)}}return b},this.cp_component_selection_meta_filter=function(b,c){if(c.step_id===this.composite_data.component.step_id){var d=0,e=this;if(a.each(e.bundled_items,function(a,b){b.$bundled_item_cart.data("quantity")>0&&d++}),0!==d&&!c.is_static()){var f=this.cp_get_formatted_contents(c);""!==f&&b.push({meta_key:wc_bundle_params.i18n_contents,meta_value:f})}}return b},this.cp_get_formatted_contents=function(b){var c="",d=[],e=b.get_selected_quantity();return a.each(this.bundled_items,function(b,c){if(c.$self.hasClass("bundled_item_hidden"))return!0;if(c.$bundled_item_cart.data("quantity")>0){var f=c.$bundled_item_cart.data("title"),g=parseInt(c.$bundled_item_cart.data("quantity")*e),h=wc_cp_get_variation_data(c.$bundled_item_cart.find(".variations")),i=g>1?"<strong>"+wc_composite_params.i18n_qty_string.replace("%s",g)+"</strong>":"",j="";h.length>0&&(a.each(h,function(a,b){j=j+'<span class="bundled_meta_element"><span class="bundled_meta_key">'+b.meta_key+':</span> <span class="bundled_meta_value">'+b.meta_value+"</span>",a!==h.length-1&&(j+='<span class="bundled_meta_value_sep">, </span>'),j+="</span>"}),f=wc_bundle_params.i18n_title_meta_string.replace("%t",f).replace("%m",'<span class="content_bundled_product_meta">'+j+"</span>")),f=wc_composite_params.i18n_title_string.replace("%t",f).replace("%q",i).replace("%p",""),d.push(f)}}),d.length>0&&a.each(d,function(a,b){c=c+'<span class="content_bundled_product_title">'+b,a!==d.length-1&&(c+='<span class="bundled_product_title_sep">, </span>'),c+="</span>"}),c},this.cp_step_is_valid_filter=function(a,b){return b.step_id===this.composite_data.component.step_id&&(a=this.passes_validation()),a},this.cp_validation_messages_action=function(b,c){if(b.step_id===this.composite_data.component.step_id&&!1===c){var d=this.get_validation_messages();a.each(d,function(a,c){b.add_validation_message(c),b.add_validation_message(c,"composite")})}},this.get_ajax_url=function(a){return woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%",a)},this.bind_event_handlers=function(){!1!==d.$addons_totals&&this.$bundle_data.on("updated_addons",function(){if(!1===d.refreshing_addons_totals&&d.passes_validation()){d.refreshing_addons_totals=!0,d.$addons_totals.data("price",d.price_data.totals.price),d.$addons_totals.data("raw-price",d.price_data.totals.price);var a=0;"yes"===wc_bundle_params.calc_taxes&&("incl"===wc_bundle_params.tax_display_shop?("yes"===wc_bundle_params.prices_include_tax&&(a=d.$addons_totals.data("addons-price")*(1-1/Number(d.price_data.base_price_tax))),d.$addons_totals.data("raw-price",d.price_data.totals.price_excl_tax-a),d.$addons_totals.data("tax-mode","excl")):("no"===wc_bundle_params.prices_include_tax&&(a=d.$addons_totals.data("addons-price")*(1-Number(d.price_data.base_price_tax))),d.$addons_totals.data("raw-price",d.price_data.totals.price_incl_tax-a),d.$addons_totals.data("tax-mode","incl"))),d.$bundle_data.trigger("woocommerce-product-addons-update"),d.refreshing_addons_totals=!1}}),this.$bundle_data.on("woocommerce-nyp-updated-item",function(b){var c=a(this).find(".nyp");c.is(":visible")&&(d.price_data.base_price=c.data("price"),d.is_initialized&&(d.dirty_subtotals=!0,d.update_totals())),b.stopPropagation()}).on("woocommerce-product-bundle-calculate-totals",function(a,b){b.calculate_totals()}).on("woocommerce-product-bundle-validation-status-changed",function(a,b){b.updated_totals()})},this.init_bundled_items=function(){d.$bundled_items.each(function(b){d.bundled_items[b]=new c(d,a(this),b),d.bind_bundled_item_event_handlers(d.bundled_items[b])})},this.bind_bundled_item_event_handlers=function(b){b.$self.on("change","input.bundled_qty",function(){var c=parseFloat(a(this).attr("min")),e=parseFloat(a(this).attr("max"));c>=0&&(parseFloat(a(this).val())<c||isNaN(parseFloat(a(this).val())))&&a(this).val(c),e>0&&parseFloat(a(this).val())>e&&a(this).val(e),b.update_selection_title(),d.update_bundle(b)}).on("change",".bundled_product_optional_checkbox input",function(c){a(this).is(":checked")?(b.$bundled_item_content.slideDown(200),b.set_selected(!0),b.$self.find(".bundled_item_qty_col .quantity").removeClass("quantity_hidden"),b.$self.find(".variations_form .variations select:eq(0)").trigger("change")):(b.$bundled_item_content.slideUp(200),b.set_selected(!1),b.$self.find(".bundled_item_qty_col .quantity").addClass("quantity_hidden"),b.add_wc_core_gallery_class(),b.$self.find(".variations_form").trigger("reset_image"),b.remove_wc_core_gallery_class()),b.update_selection_title(),d.update_bundle(b),c.stopPropagation()}).on("found_variation",function(a,c){b.variation_id=c.variation_id.toString(),d.price_data.prices[b.bundled_item_id]=Number(c.price),d.price_data.regular_prices[b.bundled_item_id]=Number(c.regular_price),d.price_data.prices_tax[b.bundled_item_id]=Number(c.price_tax),d.price_data.recurring_prices[b.bundled_item_id]=Number(c.recurring_price),d.price_data.regular_recurring_prices[b.bundled_item_id]=Number(c.regular_recurring_price),d.price_data.recurring_html[b.bundled_item_id]=c.recurring_html,d.price_data.recurring_keys[b.bundled_item_id]=c.recurring_key,b.remove_wc_core_gallery_class();var e=b.$self.find(".bundled_item_qty_col .quantity input");e.length>0&&e.attr("min",c.min_qty).attr("max",c.max_qty),b.$bundled_item_qty.trigger("change"),b.update_selection_title(),d.update_bundle(b),a.stopPropagation()}).on("reset_image",function(){b.remove_wc_core_gallery_class()}).on("woocommerce-product-addons-update",function(a){a.stopPropagation()}).on("woocommerce_variation_select_focusin",function(a){a.stopPropagation()}).on("woocommerce_variation_select_change",function(c){b.variation_id="";var e=a(this).find(".variations_form");b.is_selected()&&b.add_wc_core_gallery_class(),a(this).find(".variations .attribute-options select").each(function(){if(""===a(this).val())return e.find(".bundled_item_wrap .stock").addClass("disabled"),d.update_bundle(b),!1}),c.stopPropagation()}),b.$bundled_item_cart.on("updated_addons",function(a){var c=b.$addons_totals,e=d.price_data.addons_prices[b.bundled_item_id];c.length>0&&"undefined"!=typeof c.data("addons-raw-price")&&(e=Number(c.data("addons-raw-price"))),d.price_data.addons_prices[b.bundled_item_id]!==e&&(d.price_data.addons_prices[b.bundled_item_id]=e,d.update_totals(b)),a.stopPropagation()}).on("woocommerce-nyp-updated-item",function(a){if(b.is_nyp()&&b.$nyp.is(":visible")){var c=b.$nyp.data("price");d.price_data.prices[b.bundled_item_id]=c,d.price_data.regular_prices[b.bundled_item_id]=c,d.update_bundle(b)}a.stopPropagation()})},this.get_quantity=function(){var a=parseInt(d.$bundle_quantity.val());return a},this.update_bundle=function(a){clearTimeout(d.update_bundle_timer),d.update_bundle_timer=setTimeout(function(){d.update_bundle_task(a)},10)},this.update_bundle_task=function(b){var c=!1,e=!1,f=d.is_initialized?"":d.api.get_bundle_validation_status(),g=!0;d.validation_messages=[],a.each(d.bundled_items,function(a,b){"variable"!==b.get_product_type()&&"variable-subscription"!==b.get_product_type()||""!==b.get_variation_id()||b.is_selected()&&b.get_quantity()>0&&(g=!1)}),g||d.add_validation_message(wc_bundle_params.i18n_select_options),"yes"!==d.price_data.is_purchasable?d.add_validation_message(wc_bundle_params.i18n_unavailable_text):d.$bundle_data.triggerHandler("woocommerce-product-bundle-validate",[d]),f!==d.api.get_bundle_validation_status()&&d.$bundle_data.triggerHandler("woocommerce-product-bundle-validation-status-changed",[d]),"yes"===d.price_data.is_purchasable&&d.update_totals(b),d.passes_validation()?(a.each(d.bundled_items,function(a,b){if(!b.is_selected())return!0;var e=b.$bundled_item_cart.find("p.stock:not(.disabled)");e.hasClass("out-of-stock")&&d.price_data.quantities[b.bundled_item_id]>0&&(c=!0)}),c?d.$bundle_button.find("button").prop("disabled",!0).addClass("disabled"):d.$bundle_button.find("button").prop("disabled",!1).removeClass("disabled"),setTimeout(function(){d.$bundle_error.slideUp(200)},10),d.$bundle_wrap.trigger("woocommerce-product-bundle-show")):d.hide_bundle(),a.each(d.bundled_items,function(a,b){if(!b.is_selected())return!0;var f=b.$bundled_item_cart.find("p.stock:not(.disabled)");f.hasClass("out-of-stock")&&d.price_data.quantities[b.bundled_item_id]>0&&(e=f.clone().html(wc_bundle_params.i18n_partially_out_of_stock)),f.hasClass("available-on-backorder")&&!c&&(e=f.clone().html(wc_bundle_params.i18n_partially_on_backorder))});var h=d.$bundle_wrap.find("p.stock");e?h.length>0?h.hasClass("inactive")?(h.replaceWith(e.hide()),e.slideDown(200)):h.replaceWith(e):(d.$bundle_button.before(e.hide()),e.slideDown(200)):d.$initial_stock_status?h.replaceWith(d.$initial_stock_status):h.addClass("inactive").slideUp(200),d.is_composited()&&d.composite_data.composite.actions.do_action("component_selection_content_changed",[d.composite_data.component])},this.hide_bundle=function(b){var c=a("<ul/>");if("undefined"==typeof b){var e=d.get_validation_messages();e.length>0?a.each(e,function(b,d){c.append(a("<li/>").html(d))}):c.append(a("<li/>").html(wc_bundle_params.i18n_unavailable_text))}else c.append(a("<li/>").html(b.toString()));d.$bundle_error_content.html(c.html()),setTimeout(function(){d.$bundle_error.slideDown(200)},10),d.$bundle_button.find("button").prop("disabled",!0).addClass("disabled"),d.$bundle_wrap.trigger("woocommerce-product-bundle-hide")},this.update_price_data=function(){a.each(d.bundled_items,function(a,b){var c=b.$bundled_item_cart,e=b.bundled_item_id,f=b.get_quantity();d.price_data.quantities[e]=0,b.is_selected()&&f>0&&(d.price_data.quantities[e]=parseInt(f)),c.data("quantity",d.price_data.quantities[e]),"variable"!==b.get_product_type()&&"variable-subscription"!==b.get_product_type()||""!==b.get_variation_id()||(d.price_data.prices[e]=0,d.price_data.regular_prices[e]=0,d.price_data.prices_tax[e]=0),d.price_data.prices[e]=Number(d.price_data.prices[e]),d.price_data.regular_prices[e]=Number(d.price_data.regular_prices[e]),d.price_data.prices_tax[e]=Number(d.price_data.prices_tax[e]),d.price_data.addons_prices[e]=Number(d.price_data.addons_prices[e]),d.price_data.recurring_prices[e]=Number(d.price_data.recurring_prices[e]),d.price_data.regular_recurring_prices[e]=Number(d.price_data.regular_recurring_prices[e])})},this.update_totals=function(a){this.update_price_data(),this.calculate_subtotals(a),(d.dirty_subtotals||!1===d.is_initialized)&&(d.dirty_subtotals=!1,d.$bundle_data.triggerHandler("woocommerce-product-bundle-calculate-totals",[d]))},this.calculate_subtotals=function(b,c){var e="undefined"==typeof c?d.price_data:c;if(b="undefined"!=typeof b&&b,a.each(d.bundled_items,function(a,c){if(!1!==b&&b.bundled_item_id!==c.bundled_item_id)return!0;var f={price:0,regular_price:0,price_incl_tax:0,price_excl_tax:0},g={price:0,regular_price:0,price_incl_tax:0,price_excl_tax:0},h=e.quantities[c.bundled_item_id],i="variable"===c.get_product_type()?c.get_variation_id():c.get_product_id(),j=e.prices_tax[c.bundled_item_id],k=e.regular_prices[c.bundled_item_id]+e.addons_prices[c.bundled_item_id],l=e.prices[c.bundled_item_id]+e.addons_prices[c.bundled_item_id],m=e.regular_recurring_prices[c.bundled_item_id]+e.addons_prices[c.bundled_item_id],n=e.recurring_prices[c.bundled_item_id]+e.addons_prices[c.bundled_item_id];"yes"===wc_bundle_params.calc_taxes?i>0&&h>0&&((l>0||k>0)&&(f=d.get_taxed_totals(l,k,j,h)),(n>0||m>0)&&(g=d.get_taxed_totals(n,m,j,h))):(f.price=h*l,f.regular_price=h*k,f.price_incl_tax=h*l,f.price_excl_tax=h*l,g.price=h*n,g.regular_price=h*m,g.price_incl_tax=h*n,g.price_excl_tax=h*n),d.totals_changed(e["bundled_item_"+c.bundled_item_id+"_totals"],f)&&(d.dirty_subtotals=!0,e["bundled_item_"+c.bundled_item_id+"_totals"]=f),d.totals_changed(e["bundled_item_"+c.bundled_item_id+"_recurring_totals"],g)&&(d.dirty_subtotals=!0,e["bundled_item_"+c.bundled_item_id+"_recurring_totals"]=g)}),"undefined"!=typeof c)return e},this.get_taxed_totals=function(a,b,c,d){var e={price:a,regular_price:b,price_incl_tax:a,price_excl_tax:a};return c>0&&("yes"===wc_bundle_params.prices_include_tax?(e.price_incl_tax=a,e.price_excl_tax=a/c):(e.price_incl_tax=wc_pb_number_round(a*c),e.price_excl_tax=a),"incl"===wc_bundle_params.tax_display_shop?(e.price=e.price_incl_tax,"yes"===wc_bundle_params.prices_include_tax?e.regular_price=b:e.regular_price=wc_pb_number_round(b*c)):(e.price=e.price_excl_tax,"yes"===wc_bundle_params.prices_include_tax?e.regular_price=b/c:e.regular_price=b)),d="undefined"==typeof d?1:d,e.price=d*e.price,e.regular_price=d*e.regular_price,e.price_incl_tax=d*e.price_incl_tax,e.price_excl_tax=d*e.price_excl_tax,e},this.calculate_totals=function(b){var c="undefined"==typeof b?d.price_data:b,e=!1,f=Number(c.base_price),g=Number(c.base_regular_price),h=Number(c.base_price_tax);c.base_price_totals=this.get_taxed_totals(f,g,h),c.total=c.base_price_totals.price,c.regular_total=c.base_price_totals.regular_price,c.total_incl_tax=c.base_price_totals.price_incl_tax,c.total_excl_tax=c.base_price_totals.price_excl_tax,a.each(d.bundled_items,function(a,b){var d=c["bundled_item_"+b.bundled_item_id+"_totals"];"undefined"!=typeof d&&(c.total+=d.price,c.regular_total+=d.regular_price,c.total_incl_tax+=d.price_incl_tax,c.total_excl_tax+=d.price_excl_tax)});var i={price:c.total,regular_price:c.regular_total,price_incl_tax:c.total_incl_tax,price_excl_tax:c.total_excl_tax};e=d.totals_changed(c.totals,i),c.total_raw=i.price,"incl"===wc_bundle_params.tax_display_shop&&"no"===wc_bundle_params.prices_include_tax?c.total_raw=i.price_excl_tax:"excl"===wc_bundle_params.tax_display_shop&&"yes"===wc_bundle_params.prices_include_tax&&(c.total_raw=i.price_incl_tax);var j=d.get_bundled_subscriptions(),k={};if(j&&(a.each(j,function(a,b){var d=b.bundled_item_id;if(0===c.quantities[d])return!0;var e=c.recurring_keys[d],f=c["bundled_item_"+d+"_recurring_totals"];if("undefined"==typeof k[e]){var g={html:c.recurring_html[d],price:f.price,regular_price:f.regular_price,price_incl_tax:f.price_incl_tax,price_excl_tax:f.price_excl_tax};k[e]=g}else k[e].price+=f.price,k[e].regular_price+=f.regular_price,k[e].price_incl_tax+=f.price_incl_tax,k[e].price_excl_tax+=f.price_excl_tax}),!e)){var l=JSON.stringify(c.recurring_totals),m=JSON.stringify(k);l!==m&&(e=!0)}if(e||!1===d.is_initialized){if(c.totals=i,c.recurring_totals=k,"undefined"!=typeof b)return c;this.updated_totals()}},this.updated_totals=function(){clearTimeout(d.update_price_timer),d.update_price_timer=setTimeout(function(){d.updated_totals_task(),d.$bundle_data.triggerHandler("woocommerce-product-bundle-updated-totals",[d])},10)},this.get_price_html=function(a){var b="undefined"==typeof a?d.price_data:a,c=d.is_composited()?this.composite_data.component.get_selected_quantity():1,e="",f=(b.total_raw!==b.raw_bundle_price_min||b.raw_bundle_price_min!==b.raw_bundle_price_max)&&!1===d.get_bundled_subscriptions(),g=f?'<span class="total">'+wc_bundle_params.i18n_total+"</span>":"",h=d.is_composited()?"span":"p",i=0===b.totals.price&&"yes"===b.show_free_string?wc_bundle_params.i18n_free:wc_pb_woocommerce_number_format(wc_pb_number_format(b.totals.price*c)),j=wc_pb_woocommerce_number_format(wc_pb_number_format(b.totals.regular_price*c)),k="",l="",m="";return b.suffix_exists&&(k=b.suffix,b.suffix_contains_price_incl&&(l='<span class="amount">'+wc_pb_woocommerce_number_format(wc_pb_number_format(b.total_incl_tax*c))+"</span>",k=k.replace("{price_including_tax}",l)),b.suffix_contains_price_excl&&(m='<span class="amount">'+wc_pb_woocommerce_number_format(wc_pb_number_format(b.total_excl_tax*c))+"</span>",k=k.replace("{price_excluding_tax}",m))),e=b.totals.regular_price>b.totals.price?"<"+h+' class="price">'+b.price_string.replace("%s",g+"<del>"+j+"</del> <ins>"+i+"</ins>"+k)+"</"+h+">":"<"+h+' class="price">'+b.price_string.replace("%s",g+i+k)+"</"+h+">"},this.get_recurring_price_html=function(b){var c="undefined"==typeof b?d.price_data:b,e="",f=d.get_bundled_subscriptions();return f&&a.each(c.recurring_totals,function(a,b){var d=0==b.price?wc_bundle_params.i18n_free:wc_pb_woocommerce_number_format(wc_pb_number_format(b.price)),f=wc_pb_woocommerce_number_format(wc_pb_number_format(b.regular_price)),g="",h="",i="";c.suffix_exists&&(g=c.suffix,c.suffix_contains_price_incl&&(h='<span class="amount">'+wc_pb_woocommerce_number_format(wc_pb_number_format(b.price_incl_tax))+"</span>",g=g.replace("{price_including_tax}",h)),c.suffix_contains_price_excl&&(i='<span class="amount">'+wc_pb_woocommerce_number_format(wc_pb_number_format(b.price_excl_tax))+"</span>",g=g.replace("{price_excluding_tax}",i))),b.regular_price>b.price?b.html='<span class="amount bundled_sub_price_html">'+b.html.replace("%s","<del>"+f+"</del> <ins>"+d+"</ins>"+g)+"</span>":b.html='<span class="amount bundled_sub_price_html">'+b.html.replace("%s",d+g)+"</span>",e=(""!==e?e+'<span class="plus"> + </span>':e)+b.html}),e},this.show_price_html=function(){var b=!1;if(!1===d.get_bundled_subscriptions())b=d.price_data.total_raw!==d.price_data.raw_bundle_price_min||d.price_data.raw_bundle_price_min!==d.price_data.raw_bundle_price_max;else{var c=d.get_bundled_subscriptions("variable");c&&a.each(c,function(a,c){if(d.price_data.recurring_prices[c.bundled_item_id]>0)return b=!0,!1})}return b},this.updated_totals_task=function(){var a=d.show_price_html();if(d.is_composited()&&(a||d.composite_data.composite.api.is_component_priced_individually(this.composite_data.component.step_id)&&(a=!0),a&&!1===this.composite_data.component.is_selected_product_price_visible()&&(a=!1)),d.passes_validation()&&a){var b=d.get_price_html(),c=d.get_recurring_price_html();b=b.replace("%r",c),d.$bundle_price.html(b),c&&d.$bundle_price.find(".bundled_subscriptions_price_html").show(),d.$bundle_price.slideDown(200)}else d.$bundle_price.slideUp(200);d.is_composited()&&d.composite_data.composite.actions.do_action("component_totals_changed",[d.composite_data.component]),this.update_addons_totals()},this.update_addons_totals=function(){!1!==this.$addons_totals&&(this.$addons_totals.data("price",0),this.$addons_totals.data("raw-price",0),this.$bundle_data.trigger("woocommerce-product-addons-update"))},this.totals_changed=function(a,b){return"undefined"==typeof a||a.price!==b.price||a.regular_price!==b.regular_price||a.price_incl_tax!==b.price_incl_tax||a.price_excl_tax!==b.price_excl_tax},this.is_composited=function(){return!1!==this.composite_data},this.get_bundled_subscriptions=function(b){var c={},e=!1;return a.each(d.bundled_items,function(a,d){d.is_subscription(b)&&(c[a]=d,e=!0)}),!!e&&c},this.add_validation_message=function(a){this.validation_messages.push(a.toString())},this.get_validation_messages=function(){return this.validation_messages},this.passes_validation=function(){return!(this.validation_messages.length>0)}}function c(a,b,c){this.$self=b,this.$bundled_item_cart=b.find(".cart"),this.$bundled_item_content=b.find(".bundled_item_optional_content, .bundled_item_cart_content"),this.$bundled_item_image=b.find(".bundled_product_images"),this.$bundled_item_title=b.find(".bundled_product_title_inner"),this.$bundled_item_qty=b.find("input.bundled_qty"),this.$addons_totals=b.find("#product-addons-total"),this.$nyp=b.find(".nyp"),this.bundled_item_index=c,this.bundled_item_id=this.$bundled_item_cart.data("bundled_item_id"),this.bundled_item_title=this.$bundled_item_cart.data("title"),this.bundled_item_optional_suffix="undefined"==typeof this.$bundled_item_cart.data("optional_suffix")?wc_bundle_params.i18n_optional:this.$bundled_item_cart.data("optional_suffix"),this.product_type=this.$bundled_item_cart.data("type"),this.product_id="undefined"==typeof a.price_data.product_ids[this.bundled_item_id]?"":a.price_data.product_ids[this.bundled_item_id].toString(),this.nyp="undefined"!=typeof a.price_data.product_ids[this.bundled_item_id]&&"yes"===a.price_data.is_nyp[this.bundled_item_id],this.sold_individually="undefined"!=typeof a.price_data.product_ids[this.bundled_item_id]&&"yes"===a.price_data.is_sold_individually[this.bundled_item_id],this.variation_id="",this.has_wc_core_gallery_class=this.$bundled_item_image.hasClass("images"),"undefined"==typeof this.bundled_item_id&&(this.bundled_item_id=this.$bundled_item_cart.attr("data-bundled-item-id")),this.get_title=function(){return this.bundled_item_title},this.get_optional_suffix=function(){return this.bundled_item_optional_suffix},this.get_product_id=function(){return this.product_id},this.get_variation_id=function(){return this.variation_id},this.get_product_type=function(){return this.product_type},this.get_quantity=function(){return this.$bundled_item_qty.val()},this.is_optional=function(){return"yes"===this.$bundled_item_cart.data("optional")||1===this.$bundled_item_cart.data("optional")},this.is_selected=function(){var a=!0;return this.is_optional()&&this.$bundled_item_cart.data("optional_status")===!1&&(a=!1),a},this.set_selected=function(a){this.is_optional()&&this.$bundled_item_cart.data("optional_status",a)},this.init_scripts=function(){"undefined"!=typeof PhotoSwipe&&"yes"===wc_bundle_params.photoswipe_enabled&&this.init_photoswipe(),this.$self.find(".bundled_product_optional_checkbox input").change(),"variable"!==this.product_type&&"variable-subscription"!==this.product_type||this.$bundled_item_cart.hasClass("variations_form")||(this.$bundled_item_cart.addClass("variations_form").wc_variation_form(),this.$bundled_item_cart.find(".variations select:eq(0)").change()),this.$self.find("div").stop(!0,!0),this.update_selection_title()},this.init_photoswipe=function(){this.$bundled_item_image.wc_product_gallery({zoom_enabled:!1,flexslider_enabled:!1});var a=this.$bundled_item_image.find("a.placeholder_image");a.length>0&&a.on("click",function(){return!1})},this.update_selection_title=function(a){if(0===this.$bundled_item_title.length)return!1;var b=parseInt(this.get_quantity());if(isNaN(b))return!1;a="undefined"!=typeof a&&a,a&&(b=parseInt(this.$bundled_item_qty.attr("min")));var c=this.bundled_item_title,d=b>1?wc_bundle_params.i18n_qty_string.replace("%s",b):"",e=this.is_optional()&&""!==this.get_optional_suffix()?wc_bundle_params.i18n_optional_string.replace("%s",this.get_optional_suffix()):"",f=wc_bundle_params.i18n_title_string.replace("%t",c).replace("%q",d).replace("%o",e);this.$bundled_item_title.html(f)},this.reset_selection_title=function(){this.update_selection_title(!0)},this.is_subscription=function(a){return"simple"===a?"subscription"===this.product_type:"variable"===a?"variable-subscription"===this.product_type:"subscription"===this.product_type||"variable-subscription"===this.product_type},this.is_nyp=function(){return this.nyp},this.is_sold_individually=function(){return this.sold_individually},this.add_wc_core_gallery_class=function(){this.has_wc_core_gallery_class||this.$bundled_item_image.addClass("images")},this.remove_wc_core_gallery_class=function(){this.has_wc_core_gallery_class||this.$bundled_item_image.removeClass("images")}}jQuery(document).ready(function(a){a("body").on("quick-view-displayed",function(){
a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})}),a.fn.wc_pb_bundle_form=function(){if(!a(this).hasClass("bundle_data"))return!0;var c=a(this),d=c.data("bundle_id");if("undefined"==typeof d){if(d=c.attr("data-bundle-id"),!d)return!1;c.data("bundle_id",d)}var e=c.closest(".bundle_form"),f=e.closest(".composite_form"),g=!1,h=d;if(f.length>0){var i=e.closest(".component"),j=i.data("item_id");if(j>0&&a.isFunction(a.fn.wc_get_composite_script)){var k=f.wc_get_composite_script();if(!1!==k){var l=k.api.get_step(j);!1!==l&&(g={composite:k,component:l},h=j)}}}"undefined"!=typeof wc_pb_bundle_scripts[h]&&wc_pb_bundle_scripts[h].shutdown(),wc_pb_bundle_scripts[h]=new b({$bundle_form:e,$bundle_data:c,bundle_id:d,composite_data:g}),e.data("script_id",h),wc_pb_bundle_scripts[h].init()},a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})})}(jQuery);